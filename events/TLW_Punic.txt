namespace = ab_punic
normal_or_historical_nations = yes

#Trade company & colony culture spread
province_event = {
	id = ab_punic.0
	title = ab_punic.0.t
	desc = ab_punic.0.d
	picture = CULTURE_eventPicture
	
	hidden = yes
		
	trigger = {
		NOT = { culture = owner }
		OR = {
			AND = {
				owner = {
					is_colonial_nation = yes
				}
				OR = {
					NOT = { nationalism = 1 } 
					culture_group = owner
				}
			}
			AND = {
				is_owned_by_trade_company = yes
				num_investments_in_trade_company_region = {
					investment = trade_company_cultural_center
					value = 1
				}
			}
		}
	}

	mean_time_to_happen = {
		months = 600
		modifier = {
			factor = 0.5
			religion_group = owner
		}
		modifier = {
			factor = 0.1
			culture_group = owner
		}
	}

	option = {
		name = ab_punic.0.a
		change_culture = owner
		change_original_culture = owner
	}
}

#Punic Peace
country_event = {
	id = ab_punic.1
	title = ab_punic.1.t
	desc = ab_punic.1.d
	picture = DHOW_AT_SEA_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			add_adm_tech = 2
			add_dip_tech = 2
			add_mil_tech = 2
			add_country_modifier = {
				name = punic_peace
				duration = -1
			}
		}
	}
	
	option = {
		name = ab_punic.1.a
		custom_tooltip = PUNIC_EARLY_EVENT_CHAIN
		tooltip = {
			add_adm_tech = 2
			add_dip_tech = 2
			add_mil_tech = 2
			custom_tooltip = AB_EMPTY
			add_country_modifier = {
				name = punic_peace
				duration = -1
			}
		}
	}
}

#North America Setup
country_event = {
	id = ab_punic.2
	title = ab_punic.2.t
	desc = ab_punic.2.d
	picture = DHOW_AT_SEA_eventPicture
	
	is_triggered_only = yes
	
	fire_only_once = yes

	hidden = yes
	
	option = {
		name = ab_punic.2.a
		every_country = {
			limit = {
				technology_group = north_american
			}
			if = {
				limit = {
					primitives = no
				}
				if = {
					limit = {
						has_reform = steppe_horde
					}
					set_estate_privilege = estate_nomadic_tribes_punic_primitive_horde
				}
				else = {
					set_estate_privilege = estate_church_punic_primitive_administration
					set_estate_privilege = estate_nobles_punic_pacifist_civilization
					set_estate_privilege = estate_burghers_punic_isolationism
					set_estate_privilege = estate_church_punic_religious_tolerance
				}
			}
			# Punic League
			if = {
				limit = {
					culture = punic
				}
				country_event = {
					id = ab_punic.1
				}
			}
		}
	}
}

#Discovery of the New World
country_event = {
	id = ab_punic.3
	title = ab_punic.3.t
	desc = ab_punic.3.d
	picture = USA_EXPLORERS_eventPicture

	major = yes

	major_trigger = {
		capital_scope = {
			OR = {
				continent = europe
				region = maghreb_region
				region = egypt_region
			}
		}
	}

	fire_only_once = yes
	
	trigger = {
		any_province = {
			OR = {
				continent = north_america
				continent = south_america
			}
			NOT = { province_id = 1804 }
			NOT = { area = greenland_area }
			is_wasteland = no
			has_discovered = ROOT
		}
		capital_scope = {
			OR = {
				continent = europe
				region = maghreb_region
				region = egypt_region
			}
		}
		NOT = { has_global_flag = new_world_discovered }
	}

	immediate = {
		hidden_effect = {
			set_global_flag = new_world_discovered
		}
	}

	option = {
		name = ab_punic.3.a
		add_navy_tradition = 25
		add_country_modifier_for_age = {
			name = punic_discovery_of_north_america
			age = age_of_discovery
		}
	}
}

#A Strange Yet Familiar World
country_event = {
	id = ab_punic.4
	title = ab_punic.4.t
	desc = {
		trigger = {
			any_country = {
				culture_group = eastern_algonquian
				capital_scope = {
					has_discovered = ROOT
				}
			}
			NOT = {
				any_country = {
					culture_group = punic_g
					capital_scope = {
						has_discovered = ROOT
					}
				}
			}
		}
		desc = ab_punic.4.d1
	}
	desc = {
		trigger = {
			any_country = {
				culture_group = punic_g
				capital_scope = {
					has_discovered = ROOT
				}
			}
		}
		desc = ab_punic.4.d2
	}
	picture = DHOW_AT_SEA_eventPicture

	fire_only_once = yes
	
	trigger = {
		any_country = {
			OR = {
				culture_group = eastern_algonquian
				culture_group = punic_g
			}
			capital_scope = {
				has_discovered = ROOT
			}
		}
		capital_scope = {
			OR = {
				continent = europe
				region = maghreb_region
				region = egypt_region
			}
		}
		NOT = { has_global_flag = europe_discovered_punics }
		has_global_flag = new_world_discovered
	}

	immediate = {
		hidden_effect = {
			random_country = {
				limit = {
					OR = {
						culture_group = eastern_algonquian
						culture_group = punic_g
					}
					capital_scope = {
						has_discovered = ROOT
					}
				}
				set_country_flag = europe_discovered_punics_native_tag
				save_event_target_as = discoveredCountry
			}
			set_country_flag = europe_discovered_punics_europe_tag
			set_global_flag = europe_discovered_punics
		}
	}

	option = {
		name = ab_punic.4.a
		trigger = {
			NOT = {
				AND = {
					tag = BYZ
					event_target:discoveredCountry = {
						culture_group = punic_g
					}
				}
			}
		}
		ai_chance = { factor = 100 }
		add_treasury = -200
		event_target:discoveredCountry = {
			set_country_flag = pun_receive_colonizer_gift
			country_event = {
				id = ab_punic.5
			}
		}
	}

	option = {
		name = ab_punic.4.b
		ai_chance = { factor = 0 }
		event_target:discoveredCountry = {
			country_event = {
				id = ab_punic.5
			}
		}
	}
}

#Visitors Beyond the Sea
country_event = {
	id = ab_punic.5
	title = ab_punic.5.t
	desc = {
		trigger = {
			has_country_flag = pun_receive_colonizer_gift
		}
		desc = ab_punic.5.d1
	}
	desc = {
		trigger = {
			NOT = { has_country_flag = pun_receive_colonizer_gift }
		}
		desc = ab_punic.5.d2
	}
	picture = 15_Trade_Company_eventPicture
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			FROM = {
				capital_scope = {
					ROOT = {
						discover_province = PREV
					}
					save_event_target_as = capitalProv
				}
			}
		}
	}

	goto = capitalProv

	after = {
		hidden_effect = {
			clr_country_flag = pun_receive_colonizer_gift
			every_country = {
				limit = {
					technology_group = north_american
					NOT = { tag = ROOT }
				}
				country_event = {
					id = ab_punic.8
					days = 30
					random = 60
				}
			}
			every_country = {
				limit = {
					capital_scope = {
						OR = {
							continent = europe
							region = maghreb_region
							region = egypt_region
						}
					}
					NOT = { tag = BYZ }
					NOT = { tag = FROM }
				}
				country_event = {
					id = ab_punic.9
					days = 60
					random = 60
				}
			}
			if = {
				limit = {
					FROM = {
						tag = BYZ
					}
				}
				BYZ = {
					country_event = {
						id = ab_byzantium.61
						days = 1
					}
				}
			}
			else_if = {
				limit = {
					exists = BYZ
				}
				BYZ = {
					country_event = {
						id = ab_byzantium.61
						days = 60
						random = 60
					}
				}
			}
		}
	}
	
	option = {
		name = ab_punic.5.a
		trigger = {
			has_country_flag = pun_receive_colonizer_gift
		}
		ai_chance = { factor = 100 }
		add_treasury = 200
		add_opinion = {
			who = FROM
			modifier = opinion_received_gift
		}
		tooltip = {
			discover_province = event_target:capitalProv
		}
		custom_tooltip = AB_EMPTY
		custom_tooltip = PUN_SHARING_MAP_BEYOND_THE_SEA_FROM
		hidden_effect = {
			every_province = {
				limit = {
					culture_group = ROOT
					is_city = yes
				}
				FROM = {
					discover_province = PREV
				}
			}
			FROM = {
				country_event = {
					id = ab_punic.6
				}
			}
		}
	}

	option = {
		name = ab_punic.5.b
		trigger = {
			has_country_flag = pun_receive_colonizer_gift
		}
		ai_chance = { factor = 0 }
		tooltip = {
			discover_province = event_target:capitalProv
		}
		hidden_effect = {
			FROM = {
				country_event = {
					id = ab_punic.7
				}
			}
		}
	}

	option = {
		name = ab_punic.5.c
		trigger = {
			NOT = { has_country_flag = pun_receive_colonizer_gift }
		}
	}
}

#Locals Accept Our Gift
country_event = {
	id = ab_punic.6
	title = ab_punic.6.t
	desc = ab_punic.6.d
	picture = muslimgfx_MERCHANTS_TALKING_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ab_punic.6.a
		tooltip = {
			FROM = {
				add_opinion = {
					who = ROOT
					modifier = opinion_received_gift
				}
			}
		}
		custom_tooltip = AB_EMPTY
		custom_tooltip = PUN_SHARING_MAP_BEYOND_THE_SEA_ROOT
	}
}

#Locals Refuse Our Gift
country_event = {
	id = ab_punic.7
	title = ab_punic.7.t
	desc = ab_punic.7.d
	picture = muslimgfx_BAD_WITH_MONARCH_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ab_punic.7.a
		add_treasury = 200
	}
}

#A Strange Yet Familiar World - North America Nof
country_event = {
	id = ab_punic.8
	title = ab_punic.8.t
	desc = ab_punic.8.d
	picture = northamericagfx_CONQUEST_eventPicture
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_country = {
				limit = {
					has_country_flag = europe_discovered_punics_europe_tag
				}
				capital_scope = {
					ROOT = {
						discover_province = PREV
					}
					save_event_target_as = capitalProv
				}
				save_event_target_as = europeTag
			}
			random_country = {
				limit = {
					has_country_flag = europe_discovered_punics_native_tag
				}
				save_event_target_as = nativeTag
			}
		}
	}

	goto = capitalProv
	
	option = {
		name = ab_punic.8.a
		tooltip = {
			discover_province = event_target:capitalProv
		}
	}
}

#A Strange Yet Familiar World - Europe Nof
country_event = {
	id = ab_punic.9
	title = ab_punic.9.t
	desc = ab_punic.9.d
	picture = MERCHANTS_TALKING_eventPicture
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_country = {
				limit = {
					has_country_flag = europe_discovered_punics_europe_tag
				}
				save_event_target_as = europeTag
			}
			random_country = {
				limit = {
					has_country_flag = europe_discovered_punics_native_tag
				}
				capital_scope = {
					ROOT = {
						discover_province = PREV
					}
					save_event_target_as = capitalProv
				}
				save_event_target_as = nativeTag
			}
		}
	}

	goto = capitalProv
	
	option = {
		name = ab_punic.9.a
		tooltip = {
			discover_province = event_target:capitalProv
		}
	}
}

#Gold Found in the New World
country_event = {
	id = ab_punic.10
	title = ab_punic.10.t
	desc = ab_punic.10.d
	picture = GOLDEN_CITY_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		any_province = {
			OR = {
				continent = north_america
				continent = south_america
			}
			is_city = yes
			trade_goods = gold
			has_discovered = ROOT
		}
		capital_scope = {
			OR = {
				continent = europe
				region = maghreb_region
				region = egypt_region
			}
		}
		has_global_flag = new_world_discovered
	}

	immediate = {
		hidden_effect = {
			random_province = {
				limit = {
					OR = {
						continent = north_america
						continent = south_america
					}
					is_city = yes
					trade_goods = gold
					has_discovered = ROOT
				}
				save_event_target_as = goldProv
			}
		}
	}

	goto = goldProv

	after = {
		hidden_effect = {
			every_country = {
				limit = {
					capital_scope = {
						OR = {
							continent = europe
							region = maghreb_region
							region = egypt_region
						}	
					}
					NOT = { tag = ROOT }
				}
				country_event = {
					id = ab_punic.11
					days = 60
					random = 60
				}
			}
		}
	}
	
	option = {
		name = ab_punic.10.a
		create_conquistador = { tradition = 100 }
		add_country_modifier = {
			name = punic_gold_in_new_world
			duration = 10950
		}
	}
}

#Gold Found in the New World - Europe Nof
country_event = {
	id = ab_punic.11
	title = ab_punic.11.t
	desc = ab_punic.11.d
	picture = GOLDEN_CITY_eventPicture
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				num_of_colonists = 1
				has_idea_group = exploration_ideas
				has_idea_group = expansion_ideas
			}
		}
		name = ab_punic.11.a
		add_country_modifier = {
			name = punic_race_for_gold
			duration = 10950
		}
	}

	option = {
		trigger = {
			NOT = {
				OR = {
					num_of_colonists = 1
					has_idea_group = exploration_ideas
					has_idea_group = expansion_ideas
				}
			}
		}
		name = ab_punic.11.b
		create_explorer = { tradition = 50 }
	}
}

#European Colony Establish in North America - Hidden
country_event = {
	id = ab_punic.12
	title = ab_punic.12.t
	desc = ab_punic.12.d
	picture = COLONIZATION_eventPicture
	
	fire_only_once = yes
	
	is_triggered_only = yes

	hidden = yes
	
	option = {
		name = ab_punic.12.a
		every_country = {
			limit = {
				technology_group = north_american
			}
			country_event = {
				id = ab_punic.13
			}
		}
	}
}

#European Colony Establish in North America
country_event = {
	id = ab_punic.13
	title = ab_punic.13.t
	desc = ab_punic.13.d
	picture = COLONIZATION_eventPicture
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_province = {
				limit = {
					continent = north_america
					is_city = yes
					owner = {
						capital_scope = {
							OR = {
								continent = europe
								region = maghreb_region
								region = egypt_region
							}
						}
					}
				}
				save_event_target_as = colonyProv
			}
		}
	}

	goto = colonyProv
	
	option = {
		name = ab_punic.13.a
		add_country_modifier = {
			name = punic_trading_with_europeans
			duration = -1
		}
	}
}

#The European Threat - Hidden
country_event = {
	id = ab_punic.14
	title = ab_punic.14.t
	desc = ab_punic.14.d
	picture = northamericagfx_REVOLUTION_eventPicture
	
	fire_only_once = yes

	hidden = yes

	trigger = {
		calc_true_if = {
			amount = 10
			all_province = {
				continent = north_america
				is_city = yes
				owner = {
					OR = {
						is_colonial_nation = yes
						capital_scope = {
							OR = {
								continent = europe
								region = maghreb_region
								region = egypt_region
							}
						}
					}
				}
			}
		}
	}
	
	option = {
		name = ab_punic.14.a
		every_country = {
			limit = {
				technology_group = north_american
			}
			country_event = {
				id = ab_punic.15
			}
		}
	}
}

#The European Threat
country_event = {
	id = ab_punic.15
	title = ab_punic.15.t
	desc = ab_punic.15.d
	picture = northamericagfx_REVOLUTION_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			set_country_flag = pun_unlock_revoking_privilege
			add_stability = -1
		}
	}
	
	option = {
		name = ab_punic.15.a
		tooltip = {
			add_stability = -1
		}
		remove_country_modifier = punic_trading_with_europeans
		custom_tooltip = AB_EMPTY
		custom_tooltip = PUN_UNLOCK_REVOKING_PRIVILEGE
	}
}